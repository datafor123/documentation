import{ref as i,isRef as E,computed as d,inject as b,readonly as C,defineComponent as w,onMounted as B,h as f,watch as I}from"vue";import{useRouter as K,useRouteLocale as _,usePageLang as M}from"vuepress/client";import{deepAssign as h,isFunction as A}from"@vuepress/helper/client";import{useEventListener as P,watchImmediate as y}from"@vueuse/core";import{debounce as R}from"ts-debounce";import{removeLeadingSlash as O,resolveRoutePathFromUrl as T}from"vuepress/shared";const $=e=>{const t=P("keydown",o=>{const n=o.key==="k"&&(o.ctrlKey||o.metaKey);o.key!=="/"&&!n||(o.preventDefault(),e(),t())})},L=e=>e.button===1||e.altKey||e.ctrlKey||e.metaKey||e.shiftKey,F=()=>{const e=K();return{transformItems:t=>t.map(o=>({...o,url:`${__VUEPRESS_BASE__}${O(T(o.url,__DOCSEARCH_INDEX_BASE__))}`})),hitComponent:({hit:t,children:o})=>({type:"a",ref:void 0,constructor:void 0,key:void 0,props:{href:t.url,onClick:n=>{L(n)||(n.preventDefault(),e.push(t.url.replace(__VUEPRESS_BASE__,"/")))},children:o},__v:null}),navigator:{navigate:({itemUrl:t})=>{e.push(t.replace(__VUEPRESS_BASE__,"/"))}},transformSearchClient:t=>{const o=R(t.search,500);return{...t,search:async n=>o(n)}}}},s=__DOCSEARCH_OPTIONS__,l=i(s),k=Symbol(__VUEPRESS_DEV__?"docsearch":""),U=e=>{E(e)?y(()=>e.value,t=>{l.value=h({},s,t)}):A(e)?y(d(e),t=>{l.value=h({},s,t)}):l.value=h({},s,e)},D=()=>{const e=b(k),t=_();return d(()=>({...e.value,...e.value.locales?.[t.value]}))},V=e=>{e.provide(k,C(l))},q=(e,t=[])=>[`lang:${e}`,...Array.isArray(t)?t:[t]],j=({buttonText:e="Search",buttonAriaLabel:t=e}={})=>`<button type="button" class="DocSearch DocSearch-Button" aria-label="${t}"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">${e}</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"><svg width="15" height="15" class="DocSearch-Control-Key-Icon"><path d="M4.505 4.496h2M5.505 5.496v5M8.216 4.496l.055 5.993M10 7.5c.333.333.5.667.5 1v2M12.326 4.5v5.996M8.384 4.496c1.674 0 2.116 0 2.116 1.5s-.442 1.5-2.116 1.5M3.205 9.303c-.09.448-.277 1.21-1.241 1.203C1 10.5.5 9.513.5 8V7c0-1.57.5-2.5 1.464-2.494.964.006 1.134.598 1.24 1.342M12.553 10.5h1.953" stroke-width="1.2" stroke="currentColor" fill="none" stroke-linecap="square"></path></svg></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button>`,g=()=>{if(document.querySelector(".DocSearch-Modal"))return;const e=new Event("keydown");e.key="k",e.metaKey=!0,window.dispatchEvent(e),setTimeout(g,16)},H=e=>{const t="algolia-preconnect";("requestIdleCallback"in window?window.requestIdleCallback:setTimeout)(()=>{if(document.head.querySelector(`#${t}`))return;const o=document.createElement("link");o.id=t,o.rel="preconnect",o.href=`https://${e}-dsn.algolia.net`,o.crossOrigin="",document.head.appendChild(o)})},x=w({name:"DocSearch",props:{containerId:{type:String,default:"docsearch-container"},options:{type:Object,default:()=>({})}},setup(e){const t=D(),o=F(),n=M(),p=_(),r=i(!1),S=i(!1),a=d(()=>{const{locales:u={},...c}=e.options;return{...t.value,...c,...u[p.value]}}),m=async()=>{const{default:u}=await import("@docsearch/js"),{searchParameters:c}=a.value;u({...o,...a.value,container:`#${e.containerId}`,searchParameters:{...c,facetFilters:q(n.value,c?.facetFilters)}}),r.value=!0},v=()=>{S.value||r.value||(S.value=!0,m(),g(),I(p,m))};return $(v),B(()=>{H(a.value.appId)}),()=>[f("div",{id:e.containerId,style:{display:r.value?"block":"none"}}),r.value?null:f("div",{onClick:v,innerHTML:j(a.value.translations?.button)})]}});export{x as DocSearch,U as defineDocSearchConfig,V as injectDocSearchConfig,D as useDocSearchOptions};
//# sourceMappingURL=index.js.map
